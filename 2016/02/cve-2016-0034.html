<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>CVE-2016-0034 (Silverlight up to  5.1.41105.0) and Exploit Kits</title>

    <link rel="stylesheet" type="text/css" href="http://malware.dontneedcoffee.com/assets/css/styles_feeling_responsive.css">

  

	<script src="http://malware.dontneedcoffee.com/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="Fixed with the January 2016 Microsoft patches, CVE-2016-0034  ( MS16-006 ) is a Silverlight Memory Corruption vulnerability and it has been spotted by Kaspersky with rules to hunt Vitaliy Toropov’s unknown Silverlight exploit mentioned in HackingTeam leak.">
  	
	
	
	
	
	<link rel="canonical" href="http://malware.dontneedcoffee.com/2016/02/cve-2016-0034.html">


	<!-- Facebook Open Graph -->
	<meta property="og:title" content="CVE-2016-0034 (Silverlight up to  5.1.41105.0) and Exploit Kits">
	<meta property="og:description" content="Fixed with the January 2016 Microsoft patches, CVE-2016-0034  ( MS16-006 ) is a Silverlight Memory Corruption vulnerability and it has been spotted by Kaspersky with rules to hunt Vitaliy Toropov’s unknown Silverlight exploit mentioned in HackingTeam leak.">
	<meta property="og:logo" content="http://malware.dontneedcoffee.com/assets/img/DNC.png">
	<meta property="og:url" content="http://malware.dontneedcoffee.com/2016/02/cve-2016-0034.html">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="MDNC | Malware don't need Coffee">
	
	


	
	<!-- Twitter -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="Kafeine">
	<meta name="twitter:creator" content="Kafeine">
	<meta name="twitter:title" content="CVE-2016-0034 (Silverlight up to  5.1.41105.0) and Exploit Kits">
	<meta name="twitter:description" content="Fixed with the January 2016 Microsoft patches, CVE-2016-0034  ( MS16-006 ) is a Silverlight Memory Corruption vulnerability and it has been spotted by Kaspersky with rules to hunt Vitaliy Toropov’s unknown Silverlight exploit mentioned in HackingTeam leak.">
	
	

	<link type="text/plain" rel="author" href="http://malware.dontneedcoffee.com/humans.txt">

	

	

	<link rel="icon" sizes="32x32" href="http://malware.dontneedcoffee.com/assets/img/favicon-32x32.png">

	<link rel="icon" sizes="192x192" href="http://malware.dontneedcoffee.com/assets/img/touch-icon-192x192.png">

	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-180x180-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-152x152-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-144x144-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-120x120-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-114x114-precomposed.png">

	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-76x76-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-72x72-precomposed.png">

	<link rel="apple-touch-icon-precomposed" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-precomposed.png">	

	<meta name="msapplication-TileImage" content="http://malware.dontneedcoffee.com/assets/img/msapplication_tileimage.png">

	<meta name="msapplication-TileColor" content="#fabb00">


	

</head>
<body id="top-of-page" class="page-fullwidth">
	
	<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://malware.dontneedcoffee.com" class="icon-fisticup"> MDNC | Malware don't need Coffee</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/search/">Search</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/faq/">FAQ</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/contact/">Contact</a></li>

            
            
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li class="active"><a href="http://malware.dontneedcoffee.com/blog/">Blog</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://malware.dontneedcoffee.com/external/">External</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a href="http://malware.dontneedcoffee.com/refs/">References</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/actors/">Actors</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/authors/">Authors</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/cves/">CVEs</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/eks/">EKs (Exploit Kits)</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/malware/">Malware</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/tds/">TDS (Traffic Distribution Systems)</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          

            
            
              <li><a href="http://malware.dontneedcoffee.com/archive/">Archive</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          
        

              

          
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	

<div id="masthead-no-image-header">
	<div class="row">
		<div class="small-6 columns">
			<a id="logo" href="http://malware.dontneedcoffee.com" title="MDNC | Malware don't need Coffee – You are lost? Hunt for the static dots. You are bored? Find more trackable dots.">
				<img src="http://malware.dontneedcoffee.com/assets/img/logo.png" alt="MDNC | Malware don't need Coffee – You are lost? Hunt for the static dots. You are bored? Find more trackable dots.">
			</a>
		</div><!-- /.small-12.columns -->
	</div><!-- /.row -->
</div><!-- /#masthead -->








	


<div class="row t30">
	<div class="medium-12 columns">
		<article>
			<header>
				<p class="subheadline">2016-02-22  - Exploit Integration</p>
				<h1>CVE-2016-0034 (Silverlight up to  5.1.41105.0) and Exploit Kits</h1>
			</header>
			<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-gtxm16r9LCY/VpZuaY4mhgI/AAAAAAAAFag/pV9IaUvCTw4/s1600/2016-01-13_16h30_28.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-gtxm16r9LCY/VpZuaY4mhgI/AAAAAAAAFag/pV9IaUvCTw4/s1600/2016-01-13_16h30_28.png" /></a></div><br /><br /><br />Fixed with the January 2016 Microsoft patches, <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0034">CVE-2016-0034</a>&nbsp;&nbsp;(&nbsp;<a href="https://technet.microsoft.com/en-us/library/security/MS16-006">MS16-006</a>&nbsp;) is a Silverlight Memory Corruption vulnerability and it has been <a href="https://securelist.com/blog/research/73255/the-mysterious-case-of-cve-2016-0034-the-hunt-for-a-microsoft-silverlight-0-day/">spotted by Kaspersky</a> with rules to hunt&nbsp;<a href="https://twitter.com/VitaliyToropov">Vitaliy Toropov</a>’s unknown Silverlight exploit mentioned in HackingTeam leak.<br /><br /><b><u>Angler EK :</u></b><br /><br />On the 2016-02-18 the landing of Angler changed slightly to integrate this piece of code :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-g6BEk6C0k_4/VsXu1knc53I/AAAAAAAAFgE/sTcVM-5eqUc/s1600/2016-02-18_17h18_10.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="62" src="https://2.bp.blogspot.com/-g6BEk6C0k_4/VsXu1knc53I/AAAAAAAAFgE/sTcVM-5eqUc/s640/2016-02-18_17h18_10.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Silverlight integration Snipet from Angler Landing after decoding<br />2016-02-18</td></tr></tbody></table><div style="text-align: center;"><br /></div>resulting in a new call if silverlight is installed on the computer:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-MwNAuhVe4Ow/VsXv4XrsnKI/AAAAAAAAFgQ/1bMAy5IOPwk/s1600/2016-02-18_17h22_22.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="136" src="https://1.bp.blogspot.com/-MwNAuhVe4Ow/VsXv4XrsnKI/AAAAAAAAFgQ/1bMAy5IOPwk/s640/2016-02-18_17h22_22.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Angler EK replying without body to silverlight call<br />Here a Pass in great britain dropping Vawtrak via Bedep buildid 7786<br />2016-02-18</td></tr></tbody></table>I tried all instances i could find and the same behavior occured on all.<br /><br />2016-02-22 Here we go : call are not empty anymore.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-C28xdSQln1g/Vss05k3qfsI/AAAAAAAAFhE/3b2oFdyP19E/s1600/2016-02-22_17h09_35.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="180" src="https://2.bp.blogspot.com/-C28xdSQln1g/Vss05k3qfsI/AAAAAAAAFhE/3b2oFdyP19E/s640/2016-02-22_17h09_35.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Angler EK dropping &nbsp;Teslacrypt&nbsp;<span style="font-size: 12.8px;">via silverlight&nbsp;</span>&nbsp;5.1.41105.0<span style="font-size: 12.8px;">&nbsp;after the "EITest" redirect&nbsp;</span><br />2016-02-22</td></tr></tbody></table>I made a pass with Silverlight : 5.1.41212.0 : safe.<br /><br />Edit1 : I received confirmation that it's indeed CVE-2016-0034 from multiple analyst including <a href="https://twitter.com/antonivanovm">Anton Ivanov</a>&nbsp;(Kaspersky). Thanks !<br /><br /><br />Xap file :&nbsp;<span style="background-color: white; color: #333333; font-family: &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;arial&quot; , sans-serif; font-size: 13px; line-height: 20px;"><a href="https://www.virustotal.com/file/24b58d8446efb2391a4ee1c3b8306ccbe197a77f474a98275a9795bd08398b90/analysis/1456157464/">01ce22f87227f869b7978dc5fe625e16</a></span><br />Dll :&nbsp;<span style="background-color: white; color: #333333; font-family: &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;arial&quot; , sans-serif; font-size: 13px; line-height: 20px;"><a href="https://www.virustotal.com/file/cc39ccbdcc91d6c1e6959f528820931c73f692b653152a00fbe480081724f887/analysis/1456157506/">22a9f342eb367ea9b00508adb738d858</a></span><br />Out of topic payload :&nbsp;<a href="https://www.virustotal.com/file/2ac4d58b916a9f148567f512d1db7aa100e87c60b299dd1db4a5d6b91dfc79a8/analysis/1456157273/">6a01421a9bd82f02051ce6a4ea4e2edc</a>&nbsp;(Teslacrypt)<br />Fiddler <a href="https://www.virustotal.com/file/81eb1744daf6fb18cad609c7f05ea0be017d731691e4bcac651ff75dacf4a4b1/analysis/1456158189/">sent here</a><br /><b><u><br /></u></b><b><u>RIG :&nbsp;</u></b><br />2016-03-29<br /><a href="https://twitter.com/malc0de">Malc0de </a>spotted modification in the Rig landing indicating integration of Silverlight Exploit.<br />Here is a pass where the Silverlight is being fired and successfully exploited. CVE identification by :&nbsp;<a href="https://twitter.com/antonivanovm">Anton Ivanov</a>&nbsp;(Kaspersky)<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-90VfPZaDBTg/VvrDDdzoZfI/AAAAAAAAFkg/W5Jgxz5onF8sioOqVvPwC42aRfU8KRdvA/s1600/2016-03-29_19h58_58.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="205" src="https://2.bp.blogspot.com/-90VfPZaDBTg/VvrDDdzoZfI/AAAAAAAAFkg/W5Jgxz5onF8sioOqVvPwC42aRfU8KRdvA/s640/2016-03-29_19h58_58.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">RIG - CVE-2016-0034 - 2016-03-29</td></tr></tbody></table><div style="text-align: center;"><br /></div>Xap file in that pass : &nbsp;<span style="background-color: white; color: #333333; font-family: &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;arial&quot; , sans-serif; font-size: 13px; line-height: 20px;"><a href="https://www.virustotal.com/file/acb74c05a1b0f97cc1a45661ea72a67a080b77f8eb9849ca440037a077461f6b/analysis/1459274396/">acb74c05a1b0f97cc1a45661ea72a67a080b77f8eb9849ca440037a077461f6b</a></span><br />containing this dll :&nbsp;<span style="background-color: white; color: #333333; font-family: &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;arial&quot; , sans-serif; font-size: 13px; line-height: 20px;"><a href="https://www.virustotal.com/file/e535cf04335e92587f640432d4ec3838b4605cd7e3864cfba2db94baae060415/analysis/1459274418/">e535cf04335e92587f640432d4ec3838b4605cd7e3864cfba2db94baae060415</a></span><br /><span style="font-size: x-small;">( Out of topic payload : Qbot&nbsp;<span style="background-color: white; color: #333333; font-family: &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;arial&quot; , sans-serif; line-height: 20px;"><a href="https://www.virustotal.com/file/3242561cc9bb3e131e0738078e2e44886df307035f3be0bd3defbbc631e34c80/analysis/1459274636/">3242561cc9bb3e131e0738078e2e44886df307035f3be0bd3defbbc631e34c80</a>&nbsp;)</span></span><br /><b style="text-decoration: underline;">Files :</b>&nbsp;<a href="https://files.dontneedcoffee.com/index.php/s/ajDmgJPPCNqJ48R">Fiddler and sample</a>&nbsp;<span style="font-size: x-small;">(password is malware)</span><br /><b><u><br /></u></b><b><u>Reading :</u></b><br /><a href="https://securelist.com/blog/research/73255/the-mysterious-case-of-cve-2016-0034-the-hunt-for-a-microsoft-silverlight-0-day/">The Mysterious Case of CVE-2016-0034: the hunt for a Microsoft Silverlight 0-day</a> - 2016-01-13 - <a href="https://twitter.com/craiu">Costin Raiu</a> &amp;<a href="https://twitter.com/antonivanovm"> Anton Ivanov</a> - Kaspersky<br /><br /><b><u>Post Publication Reading:</u></b><br />(PDF) <a href="http://download.bitdefender.com/resources/media/materials/white-papers/en/Angler_Silverlight_Exploit_(CVE-2016-0034)_-_Analysis_by_Bitdefender.pdf">Analysis of Angler's new silverlight Exploit</a> - 2016-03-10 - Bitdefender Labs
		</article>
	</div><!-- /.medium-12.columns -->
</div><!-- /.row -->




	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black"></h5>

            <p class="shadow-black">
              Sleep is a symptom of caffeine deprivation.
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Services</h5>
              
            
              
            
              
            
              
            
              
            

              <ul class="no-bullet shadow-black">
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com"  title=""></a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/contact/"  title="Contact">Contact</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/feed.xml"  title="Subscribe to RSS Feed">RSS</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/atom.xml"  title="Subscribe to Atom Feed">Atom</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/sitemap.xml"  title="Sitemap for Google Webmaster Tools">sitemap.xml</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            
              
                <h5 class="shadow-black">Merci</h5>
              
            
              
            
              
            

            <ul class="no-bullet shadow-black">
            
              
                <li >
                  <a href="http://malware.dontneedcoffee.com"  title=""></a>
                </li>
            
              
                <li class="network-misp" >
                  <a href="https://www.misp-project.org/" target="_blank"  title="MISP Project - Open Source Threat Intelligence Platform & Open Standards For Threat Information Sharing">MISP</a>
                </li>
            
              
                <li class="network-cuckoo" >
                  <a href="https://cuckoosandbox.org/" target="_blank"  title="Automate Malware Analysis">Cuckoo</a>
                </li>
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
              <li><a href="http://github.com/Kafeine" target="_blank" class="icon-github" title="Code and more..."></a></li>
            
              <li><a href="http://twitter.com/Kafeine" target="_blank" class="icon-twitter" title="Last tweets"></a></li>
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="http://malware.dontneedcoffee.com/assets/js/javascript.min.js"></script>














</body>
</html>


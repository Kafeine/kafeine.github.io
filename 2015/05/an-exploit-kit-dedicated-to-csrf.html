<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>An  Exploit Kit dedicated to CSRF Pharming</title>

    <link rel="stylesheet" type="text/css" href="http://malware.dontneedcoffee.com/assets/css/styles_feeling_responsive.css">

  

	<script src="http://malware.dontneedcoffee.com/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="A look at a Malvertising driving traffic to a &quot;Router Exploit-Kit&quot;">
  	
	
	
	
	
	<link rel="canonical" href="http://malware.dontneedcoffee.com/2015/05/an-exploit-kit-dedicated-to-csrf.html">


	<!-- Facebook Open Graph -->
	<meta property="og:title" content="An  Exploit Kit dedicated to CSRF Pharming">
	<meta property="og:description" content="A look at a Malvertising driving traffic to a &quot;Router Exploit-Kit&quot;">
	<meta property="og:logo" content="http://malware.dontneedcoffee.com/assets/img/DNC.png">
	<meta property="og:url" content="http://malware.dontneedcoffee.com/2015/05/an-exploit-kit-dedicated-to-csrf.html">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="MDNC | Malware don't need Coffee">
	
	


	
	<!-- Twitter -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="Kafeine">
	<meta name="twitter:creator" content="Kafeine">
	<meta name="twitter:title" content="An  Exploit Kit dedicated to CSRF Pharming">
	<meta name="twitter:description" content="A look at a Malvertising driving traffic to a &quot;Router Exploit-Kit&quot;">
	
	

	<link type="text/plain" rel="author" href="http://malware.dontneedcoffee.com/humans.txt">

	

	

	<link rel="icon" sizes="32x32" href="http://malware.dontneedcoffee.com/assets/img/favicon-32x32.png">

	<link rel="icon" sizes="192x192" href="http://malware.dontneedcoffee.com/assets/img/touch-icon-192x192.png">

	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-180x180-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-152x152-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-144x144-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-120x120-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-114x114-precomposed.png">

	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-76x76-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-72x72-precomposed.png">

	<link rel="apple-touch-icon-precomposed" href="http://malware.dontneedcoffee.com/assets/img/apple-touch-icon-precomposed.png">	

	<meta name="msapplication-TileImage" content="http://malware.dontneedcoffee.com/assets/img/msapplication_tileimage.png">

	<meta name="msapplication-TileColor" content="#fabb00">


	

</head>
<body id="top-of-page" class="page-fullwidth">
	
	<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://malware.dontneedcoffee.com" class="icon-fisticup"> MDNC | Malware don't need Coffee</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/search/">Search</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/faq/">FAQ</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://malware.dontneedcoffee.com/contact/">Contact</a></li>

            
            
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li class="active"><a href="http://malware.dontneedcoffee.com/blog/">Blog</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://malware.dontneedcoffee.com/external/">External</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a href="http://malware.dontneedcoffee.com/refs/">References</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/actors/">Actors</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/authors/">Authors</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/cves/">CVEs</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/eks/">EKs (Exploit Kits)</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/malware/">Malware</a></li>
                    

                      

                      <li><a href="http://malware.dontneedcoffee.com/refs/tds/">TDS (Traffic Distribution Systems)</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          

            
            
              <li><a href="http://malware.dontneedcoffee.com/archive/">Archive</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          
        

              

          
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	

<div id="masthead-no-image-header">
	<div class="row">
		<div class="small-6 columns">
			<a id="logo" href="http://malware.dontneedcoffee.com" title="MDNC | Malware don't need Coffee – You are lost? Hunt for the static dots. You are bored? Find more trackable dots.">
				<img src="http://malware.dontneedcoffee.com/assets/img/logo.png" alt="MDNC | Malware don't need Coffee – You are lost? Hunt for the static dots. You are bored? Find more trackable dots.">
			</a>
		</div><!-- /.small-12.columns -->
	</div><!-- /.row -->
</div><!-- /#masthead -->








	


<div class="row t30">
	<div class="medium-12 columns">
		<article>
			<header>
				<p class="subheadline">2015-05-22  - Landscape</p>
				<h1>An  Exploit Kit dedicated to CSRF Pharming</h1>
			</header>
			<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-BNh1XkaZDmQ/VV84UHINfXI/AAAAAAAAErA/UOm--C5NNkY/s1600/2015-05-22_14h17_35.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="115" src="http://2.bp.blogspot.com/-BNh1XkaZDmQ/VV84UHINfXI/AAAAAAAAErA/UOm--C5NNkY/s200/2015-05-22_14h17_35.png" width="200" /></a></div><br /><br /><br />In april, studying a redirector that was previously associated with some (RIP) Sweet Orange activity, I landed on a TDS that was strangely denying usual driveby criteria (US,EU, JP,... Internet Explorer, Firefox...).<br /><br />A try with Android did not give better result. Trying with Chrome I was expecting a "Browlock" ransomware but instead I got what looks like a <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29">CSRF</a>&nbsp;(Cross-Site Request Forgery) Soho Pharming &nbsp;(a router DNS changer)<br /><br />The code ( <a href="http://pastebin.com/raw.php?i=TsEUAJtq">http://pastebin.com/raw.php?i=TsEUAJtq</a>&nbsp;) &nbsp;was easy to read. The DNS written in clear, some exploits. I decided not to look in details.<br /><br />But when i faced those redirections one month later, there was many improvement including some obfuscation.<br /><br />The traffic brought to it when active is a 6 figure one<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-AEMNspPdHRo/VV7iY3vdwzI/AAAAAAAAEnM/eDUYcvqwdYw/s1600/2015-05-12_17h42_13.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="147" src="http://4.bp.blogspot.com/-AEMNspPdHRo/VV7iY3vdwzI/AAAAAAAAEnM/eDUYcvqwdYw/s640/2015-05-12_17h42_13.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">1 Week of traffic to the "router Exploit Kit"</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-x1q1P0DDS8Q/VV7i14raadI/AAAAAAAAEnU/ULxX4pXG0cA/s1600/2015-05-16_22h40_13.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="356" src="http://4.bp.blogspot.com/-x1q1P0DDS8Q/VV7i14raadI/AAAAAAAAEnU/ULxX4pXG0cA/s640/2015-05-16_22h40_13.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Geo Repartition of the Chrome traffic 2015-05-16</td></tr></tbody></table><br />With my first &nbsp;pass I only got those call :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-ABQlzyOyMec/VV7mveCqIoI/AAAAAAAAEng/154iZyCJ8jA/s1600/2015-05-22_10h18_38.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="238" src="http://3.bp.blogspot.com/-ABQlzyOyMec/VV7mveCqIoI/AAAAAAAAEng/154iZyCJ8jA/s640/2015-05-22_10h18_38.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Router EK - Dodged client : reason bad network configuration<br />2015-05-12</td></tr></tbody></table>The landing is calling CryptoJS AES encoding.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-SIiT8iQcovM/VV7o0BX3QZI/AAAAAAAAEns/v2wQfaZuadw/s1600/2015-05-22_10h26_38.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="520" src="http://1.bp.blogspot.com/-SIiT8iQcovM/VV7o0BX3QZI/AAAAAAAAEns/v2wQfaZuadw/s640/2015-05-22_10h26_38.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">RouterBF - Landing - 2015-05-12<br />featuring some CryptoJS AES encoding</td></tr></tbody></table>This call :<br /><br />GET http://ngwblnlfmvjazwf17swal1tn5qqjbx.informationdrommers .xyz:81/track/e_x.js<br />200 OK (application/javascript)<br /><div><br /></div><div>is the implementation of <a href="https://github.com/diafygi/webrtc-ips">Daniel Roesler's webrtc-ips</a>&nbsp;which allow local and public IP adresses gathering via STUN requests. (<a href="https://diafygi.github.io/webrtc-ips/">Demo proposed by @diafygi</a>)</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-aPF-Tm_xe_Q/VV7rpQdCEdI/AAAAAAAAEoA/veWlPBYIf5w/s1600/2015-05-18_13h49_46.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="116" src="http://1.bp.blogspot.com/-aPF-Tm_xe_Q/VV7rpQdCEdI/AAAAAAAAEoA/veWlPBYIf5w/s640/2015-05-18_13h49_46.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: 12.8000001907349px;">STUN calls generated by the "Router EK" captured in Wireshark</span><br /><span style="font-size: 12.8000001907349px;">2015-05-18<br />(note: that pass was successfull - cf local IP range)</span></td></tr></tbody></table>Once decoded the AES encoded piece of code was like :<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-Tb53y4O0T-8/VV7x0fr7z8I/AAAAAAAAEoQ/1sWRIbuRvSc/s1600/2015-05-22_11h06_23.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://1.bp.blogspot.com/-Tb53y4O0T-8/VV7x0fr7z8I/AAAAAAAAEoQ/1sWRIbuRvSc/s640/2015-05-22_11h06_23.png" width="442" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Decoded piece of the landing.<br />We can see some router fingerprinting by image path and size.<br />Some IP range condition (otherwise redirect to : "about:blank"</td></tr></tbody></table>Few days later the code moved again<br /><br />Landing was smaller, some AES encoded strings were moved to separated calls :<br />/stat/dnd.php<br />/stat/gcd.php?l=1<br /><div><br /></div><div>The router list was improved :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-EBNfLjuWwWI/VV75eKtuj5I/AAAAAAAAEog/lE4tLpuDJDw/s1600/2015-05-22_11h39_50.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://2.bp.blogspot.com/-EBNfLjuWwWI/VV75eKtuj5I/AAAAAAAAEog/lE4tLpuDJDw/s640/2015-05-22_11h39_50.png" width="204" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">more than 55 routers from a dozen of brands</td></tr></tbody></table></div><div>Here is the list on the 2015-05-18 :</div><div><br /></div><div><div>ASUS AC68U</div><div>ASUS RTN56U &amp; ASUS RTN10P &amp; ASUS-RTN66U &amp; ASUS-RT56-66-10-12</div><div>ASUS-RTG32</div><div>BELK-PHILIPS (?)</div><div>BELKIN F5D7230-4</div><div>BELKIN F5D8236-4V2</div><div>BELKIN F9k1105V2</div><div>BELKIN-F5D7231-4</div><div>BELKIN-F5D7234-4</div><div>D'LINK DIR-600</div><div>D'LINK DIR-604</div><div>D'LINK DIR-645</div><div>D'LINK DIR-810L &amp; DIR-826L &amp; DIR-615 &amp; DIR-651 &amp; DIR-601 &amp; WBR1310 &amp; D2760</div><div>D'LINK DSLG604T</div><div>D'LINK-DIR-2740R&nbsp;</div><div>EDIMAX BR6208AC</div><div>LINKSYS BEFW11S4 V4</div><div>LINKSYS L120</div><div>LINKSYS WRT54GSV7</div><div>LINKSYS-BEFW11S4 V4</div><div>LINKSYS-LWRT54GLV4</div><div>LINKSYS-WRT54GV8</div><div>LINKSYS-X3000</div><div>LINSYS L000</div><div>Medialink WAPR300N</div><div>Microsoft MN-500</div><div>NETGEAR DGN1000B &amp; DG834v3 &amp; DGN2200</div><div>NETGEAR WNDR3400</div><div>NETGEAR-DGN1000 &amp; NETGEAR-DGN2200</div><div>NETGEAR-WNR834Bv2</div><div>NETGEAR-WPN824v3&nbsp;</div><div>NETIS WF2414</div><div>Netis WF2414</div><div>TENDA 11N</div><div>TPLI ALL</div><div>TPLI-WR940N &amp; WR941ND &amp; WR700</div><div>TRENDNET E300-150</div><div>TRIP-TM01&nbsp;</div><div>TRIP-TM04</div><div>Trendnet TW100S4W1CA</div><div>ZYXEL MVR102</div><div>ZYXEL NBG416</div><div>ZYXEL-NBG334W</div></div><div><br /></div><div><br /></div>New features to detect devices on the client machine and fingerprint it using a fork of this script :<br /><a href="https://github.com/muaz-khan/DetectRTC/blob/master/DetectRTC.js">https://github.com/muaz-khan/DetectRTC/blob/master/DetectRTC.js</a><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-9Ftzc-TMYaw/VV8dTfiRoRI/AAAAAAAAEp8/d1PwVl-h5vQ/s1600/2015-05-22_14h11_41.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-9Ftzc-TMYaw/VV8dTfiRoRI/AAAAAAAAEp8/d1PwVl-h5vQ/s1600/2015-05-22_14h11_41.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Data gathered by the KIT via DetectRTC</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-Th-tprv-BFk/VV8cY7sMyVI/AAAAAAAAEp0/sg-dTcPkdB8/s1600/2015-05-16_17h27_37.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-Th-tprv-BFk/VV8cY7sMyVI/AAAAAAAAEp0/sg-dTcPkdB8/s1600/2015-05-16_17h27_37.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: 12.8000001907349px;">Example of DetectRTC result reply before encoding and passed as parameter</span></td></tr></tbody></table><br /><br />With those information on how to get attacked, I moved the VM to an "accepted" IP-range and faked owning a targeted router :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-NI-lnD1Z5kw/VV8t_08xivI/AAAAAAAAEqg/5v2OEKU2XhM/s1600/2015-05-22_13h27_01.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://2.bp.blogspot.com/-NI-lnD1Z5kw/VV8t_08xivI/AAAAAAAAEqg/5v2OEKU2XhM/s640/2015-05-22_13h27_01.png" width="562" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: 12.8000001907349px;">DNSChanger EK tricking Chrome to exploit a D'LINK (CVE-2015-1187) then change DNS</span><br /><span style="font-size: 12.8000001907349px;">(to 185.82.216.86)</span><br /><span style="font-size: 12.8000001907349px;">&nbsp;and reboot</span></td></tr></tbody></table><br /><br />Knowing <a href="http://packetstormsecurity.com/files/131465/D-Link-TRENDnet-NCC-Service-Command-Injection.html">CVE-2015-1187</a>&nbsp; has been released on 2015-03-02 i guess this attack is pretty effective ( the % of router updated &nbsp;in the past two months is probably really low)<br /><br /><br />Here is the code sent in an AES encoded form for the D'LINK attack<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-nijqec8Z7hE/VV8Vb1M7gAI/AAAAAAAAEpE/rsfFhGlpIw4/s1600/2015-05-22_13h10_14.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://2.bp.blogspot.com/-nijqec8Z7hE/VV8Vb1M7gAI/AAAAAAAAEpE/rsfFhGlpIw4/s640/2015-05-22_13h10_14.png" width="416" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">D'LINK attack instructions - 2015-05-18</td></tr></tbody></table>Looking at the code it seems we can say CVE-2008-1244 is there.<br />(note that Router are not updated automatically, so while we hardly see some &gt;3 years old CVE in Browser Exploit Pack, for router this might still be relevant),&nbsp;CVE-2013-2645 might be here as well. We can bet there are a lot more buried in the post commands dedicated to some of the models.<br /><br />I made a pass for some Linksys :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-vAKcJIj3SkU/VV8bWZ1hE8I/AAAAAAAAEpc/igNy9xWMgoQ/s1600/2015-05-22_14h01_25.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="448" src="http://2.bp.blogspot.com/-vAKcJIj3SkU/VV8bWZ1hE8I/AAAAAAAAEpc/igNy9xWMgoQ/s640/2015-05-22_14h01_25.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The DNSChanger EK &nbsp;trying to perform a dictionnary attack on a LinkSys WRT54G<br />2015-05-18</td></tr></tbody></table><br />For the Microsoft MN500 :<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-POttXA9-orE/VV8ubLqSYmI/AAAAAAAAEqo/q0H4WCRfnYs/s1600/2015-05-22_14h20_06.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="420" src="http://3.bp.blogspot.com/-POttXA9-orE/VV8ubLqSYmI/AAAAAAAAEqo/q0H4WCRfnYs/s640/2015-05-22_14h20_06.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: 12.8000001907349px;">A Router EK &nbsp;trying to perform a bruteforce attack on a Microsoft MN500<br />2015-05-18</span></td></tr></tbody></table>2 more (Asus and Edimax) are shared at the end<br /><br />I made another pass today, and saw an additionnal call :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-5H5ka4kSS8E/VV8upgSYaJI/AAAAAAAAEqw/7g0bi0Hpf4o/s1600/2015-05-22_14h59_14.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="386" src="http://1.bp.blogspot.com/-5H5ka4kSS8E/VV8upgSYaJI/AAAAAAAAEqw/7g0bi0Hpf4o/s640/2015-05-22_14h59_14.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">A router EK 2015-05-22 - one more call, another DNS Server.</td></tr></tbody></table><br /><br />DNS are now changed to :&nbsp;217.12.202.93 (previously it was : &nbsp;185.82.216.86, and earlier&nbsp;<span style="white-space: pre-wrap;">37.139.50.45 - quite surely some others have been used ). Always Google DNS as failover to avoid raising alarm if something goes wrong with the first IP.</span><br /><span style="white-space: pre-wrap;"><br /></span><span style="white-space: pre-wrap;">We know they can do : bank/webmoney MITM, phishing, adfraud etc...but to the question : "</span><span style="white-space: pre-wrap;">what are they doing ?"... I have no reply yet (if you figure out, i'd be more than happy to get a mail :) )</span><br /><br />[Edit : 2015-05-26]<br />If you think you might be compromised and don't know exactly how to figure out, you can give<br />&nbsp;- &nbsp;<a href="http://www.routercheck.com/">RouterCheck</a>&nbsp;(Android App)<br />&nbsp;- &nbsp;<a href="https://campaigns.f-secure.com/router-checker/">F-Secure Router Checker</a> (Web)<br />a try.<br />If you are aware of other "easy" methods to do it, feel free to share i'll report it here<br />]<br /><br /><span style="white-space: pre-wrap;"><b><u>Thanks</u></b>  <a href="https://twitter.com/node5">Will Metcalf</a> (Emerging Threats) for his help.</span><br /><span style="white-space: pre-wrap;"><br /></span><span style="white-space: pre-wrap;"><u style="font-weight: bold;">Files :</u> <a href="http://files.dontneedcoffee.com/index.php/s/2BV74r231YraUxo">RouterBF_2015-05-22.zip</a> (5 fiddlers, some piece of decoded js)</span><br /><span style="white-space: pre-wrap;"><br /></span><span style="white-space: pre-wrap;"><b><u>Read more :</u></b></span><br /><a href="http://sentrant.com/2015/03/25/ad-fraud-malware-hijacks-router-dns-injects-ads-via-google-analytics/">Ad-Fraud Malware Hijacks Router DNS – Injects Ads Via Google Analytics</a> - 2015-03-25 -&nbsp;Sergei Frankoff - Sentrant<br /><a href="http://http//www.cert.pl/news/8019/langswitch_lang/en">Large-scale DNS redirection on home routers for financial theft</a> - 2014-02-06 - Cert-PL<br />[PDF] : <a href="https://www.team-cymru.com/ReadingRoom/Whitepapers/2013/TeamCymruSOHOPharming.pdf">Soho Pharming</a> 2013 - Team Cymru's TIG<br />[PDF Whitepaper]:&nbsp;<a href="http://www.symantec.com/avcenter/reference/Driveby_Pharming.pdf">Drive-By Pharming</a>&nbsp;- 2006-12-13 -&nbsp;Sid Stamm (Indiana University, Bloomington) -&nbsp;Zulfikar Ramzan (symantec) -&nbsp;Markus Jakobsson (Indiana University, Bloomington)<br /><br /><br /><br /><br /><br />
		</article>
	</div><!-- /.medium-12.columns -->
</div><!-- /.row -->




	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black"></h5>

            <p class="shadow-black">
              Sleep is a symptom of caffeine deprivation.
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Services</h5>
              
            
              
            
              
            
              
            
              
            

              <ul class="no-bullet shadow-black">
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com"  title=""></a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/contact/"  title="Contact">Contact</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/feed.xml"  title="Subscribe to RSS Feed">RSS</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/atom.xml"  title="Subscribe to Atom Feed">Atom</a>
                  </li>
              
                
                  <li >
                    <a href="http://malware.dontneedcoffee.com/sitemap.xml"  title="Sitemap for Google Webmaster Tools">sitemap.xml</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            
              
                <h5 class="shadow-black">Merci</h5>
              
            
              
            
              
            

            <ul class="no-bullet shadow-black">
            
              
                <li >
                  <a href="http://malware.dontneedcoffee.com"  title=""></a>
                </li>
            
              
                <li class="network-misp" >
                  <a href="https://www.misp-project.org/" target="_blank"  title="MISP Project - Open Source Threat Intelligence Platform & Open Standards For Threat Information Sharing">MISP</a>
                </li>
            
              
                <li class="network-cuckoo" >
                  <a href="https://cuckoosandbox.org/" target="_blank"  title="Automate Malware Analysis">Cuckoo</a>
                </li>
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
              <li><a href="http://github.com/Kafeine" target="_blank" class="icon-github" title="Code and more..."></a></li>
            
              <li><a href="http://twitter.com/Kafeine" target="_blank" class="icon-twitter" title="Last tweets"></a></li>
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="http://malware.dontneedcoffee.com/assets/js/javascript.min.js"></script>














</body>
</html>


<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-MWdzB7RGtQg/UHQFSSuMPII/AAAAAAAABk0/1avi1Nyz4vc/s1600/screenshot_511.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-MWdzB7RGtQg/UHQFSSuMPII/AAAAAAAABk0/1avi1Nyz4vc/s1600/screenshot_511.png" /></a></div><br /><br /><br />If you follow this blog you'll get fast sick of <a href="http://malware.dontneedcoffee.com/2012/10/newcoolek.html">Cool EK</a> and <a href="http://malware.dontneedcoffee.com/2012/10/reveton-hu-lv-sk-sl-tr-ro-so-spreading.html">Reveton</a>.<br />The Cool EK of Reveton distributors (yes it's also used by other groups, for instance the <a href="http://www.botnets.fr/index.php/CBeplay.P">CBeplay.P</a>&nbsp;ransomware distributors) is moving a lot.<br /><br />Hunting for the <a href="http://krebsonsecurity.com/2012/11/experts-warn-of-zero-day-exploit-for-adobe-reader/">Adobe Reader XI 0 day</a>&nbsp;announced by Brian Krebs, I found a 0.7.9 PluginDetect...<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-W_FE5wfbmU4/UJzQ-HItr0I/AAAAAAAACKE/Y2su5K5rO58/s1600/screenshot_1452.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-W_FE5wfbmU4/UJzQ-HItr0I/AAAAAAAACKE/Y2su5K5rO58/s1600/screenshot_1452.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">PluginDetect 0.7.9 on Cool EK</td></tr></tbody></table><br /><br />that whispered me<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-0rlhJqo4t-c/UJzRJRkqswI/AAAAAAAACKM/yqMsU2Itv5w/s1600/screenshot_1451.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="150" src="http://1.bp.blogspot.com/-0rlhJqo4t-c/UJzRJRkqswI/AAAAAAAACKM/yqMsU2Itv5w/s640/screenshot_1451.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">"new" jar file on Cool EK</td></tr></tbody></table><br /><br />to check the exploit kit with Java 1.7 update 7 and....Hello my friend...the 0 day after you know...the previous 0 day (read : <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5076">CVE-2012-5076</a>&nbsp;after <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4681">CVE-2012-4681</a>)<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-K36FUFHPQ0s/UJzobtnh1HI/AAAAAAAACOE/utrSq0pjfHk/s1600/screenshot_1456.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-K36FUFHPQ0s/UJzobtnh1HI/AAAAAAAACOE/utrSq0pjfHk/s1600/screenshot_1456.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From "Battlefield" to "Hello my friend..."</td></tr></tbody></table><br /><i><span style="color: #351c75;">&lt;edit1 :</span></i><br /><i><span style="color: #351c75;">Note: I presumed it was CVE-2012-5067 as : it's not working on j7u9, it's working on j7u7...it could be something else thought chances were low... I was wrong.</span></i><i><span style="color: #351c75;">&nbsp; see at the end. /&gt;</span></i><br /><i><span style="color: #351c75;">&lt;edit5:&gt;</span></i><br /><iframe allowfullscreen="allowfullscreen" frameborder="0" height="360" src="http://www.youtube.com/embed/Q9XoKqM0xcw" width="640"></iframe> <i><span style="color: #351c75;">Cool EK infecting Windows 7 x64 via IE9 plugin Java 7u7 and pushing Reveton Ransomware which gather it's Turkish disguise from its C&amp;C</span></i><br /><i><span style="color: #351c75;">&lt;/edit5&gt;</span></i><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-RA4ga1mIuVM/UJzlJ14698I/AAAAAAAACM8/T-nXbfsM5NQ/s1600/screenshot_1453.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-RA4ga1mIuVM/UJzlJ14698I/AAAAAAAACM8/T-nXbfsM5NQ/s1600/screenshot_1453.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Cool EK (Reveton distributor version)&nbsp;<span style="color: #0000ee;"><u>CVE-2012-5076</u>&nbsp;</span>Path</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-btQ-nSmqvLI/UJzqmmNR98I/AAAAAAAACOU/9rMFDm0p36I/s1600/screenshot_1455.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-btQ-nSmqvLI/UJzqmmNR98I/AAAAAAAACOU/9rMFDm0p36I/s1600/screenshot_1455.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Java 1.7 u7 on IE9 - Win7</td></tr></tbody></table><br /><div><br /><div class="separator" style="clear: both; text-align: center;"></div>With same configuration&nbsp;(j7u7 + IE9 + Win7)&nbsp;on Cool EK from CBeplay.P distributors you'll get &nbsp;:<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td><a href="http://1.bp.blogspot.com/-niidJEhcXdI/UJzXoEj_2MI/AAAAAAAACL0/tINt_2zhtdI/s1600/screenshot_1448.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-niidJEhcXdI/UJzXoEj_2MI/AAAAAAAACL0/tINt_2zhtdI/s1600/screenshot_1448.png" /></a></td></tr><tr><td class="tr-caption" style="font-size: 13px;">CBeplay.P Cool EK : No &nbsp;CVE-2012-5076 path</td></tr></tbody></table><br />Here is the &nbsp;CVE-2012-5076 working path :<br />http://193.1xx.120.xx/r/l/***_sessions_****.php &nbsp;(including plugin detect 0.7.9 )<br />http://193.1xx.120.xx/r/64size_font.eot - ee1ed92474bd1de3093d056d8c4404ff (Font from duqu like drop)<br />http://193.1xx.120.xx/r/l/getJavaInfo.jar -&nbsp;fad89bdfdce9322767944f0e1f15a009 (java detect)<br />http://193.1xx.120.xx/r/media/new.jar -&nbsp;<a href="https://www.virustotal.com/file/327a1cbf1e1e06df765f959ad5b05089/analysis/">327a1cbf1e1e06df765f959ad5b05089</a> (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5067">&nbsp;CVE-2012-5076</a>)<br />http://193.1xx.120.xx/r/f.php?k=2&amp;e=0&amp;f=0 -&nbsp;<a href="https://www.virustotal.com/file/746d7f49ceadf9315b31957f5da32fb1/analysis/">746d7f49ceadf9315b31957f5da32fb1</a> (Reveton - no bypass proxy as we saw in last path of CVE-2012-4681)<br /><div><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-PnrlrcX7S_o/UJ57CevamQI/AAAAAAAACZE/VpuAXko44E4/s1600/screenshot_1454.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="364" src="http://4.bp.blogspot.com/-PnrlrcX7S_o/UJ57CevamQI/AAAAAAAACZE/VpuAXko44E4/s640/screenshot_1454.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">new.jar in Java Decompiler</td></tr></tbody></table><br /><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div>&lt;edit2: 17:59 09/11/12&gt;<br />With some help , am able to put more information about this jar file.<br />The&nbsp;bagdfssdb.class is encrypted with ZelixKlassMaster<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div style="text-align: center;">&nbsp;<a href="http://4.bp.blogspot.com/--ROngOoN06c/UJ0KFQKbtpI/AAAAAAAACSE/GbepW7ie_4M/s1600/screenshot_1460.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/--ROngOoN06c/UJ0KFQKbtpI/AAAAAAAACSE/GbepW7ie_4M/s1600/screenshot_1460.png" /></a></div>So we have to take a look at the method clinit to find the key :<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-pC2aD3vATvQ/UJ0N69EBeXI/AAAAAAAACUM/29_WdIH9HZg/s1600/screenshot_1461.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-pC2aD3vATvQ/UJ0N69EBeXI/AAAAAAAACUM/29_WdIH9HZg/s1600/screenshot_1461.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Method: &lt;clinit&gt; in bagdfssda</td></tr></tbody></table><br />0000004E : tableswitch &nbsp; &nbsp; &nbsp; &nbsp; l: 0, h: 3, def: pos.00000080, pos.(0000006C, 00000071, 00000076, 0000007B)<br />0000006C : bipush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;55<br />0000006E : goto &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pos.00000082<br />00000071 : bipush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;120<br />00000073 : goto &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pos.00000082<br />00000076 : bipush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;64<br />00000078 : goto &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pos.00000082<br />0000007B : bipush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;24<br />0000007D : goto &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pos.00000082<br />00000080 : bipush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;81<br /><div><br /></div><div>Using the zkm_decrypt.py provided with DirtyJOE and the key&nbsp;[55,120, 64, 24, 81]</div><div><br /></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-MbOqpsdjh8o/UJ0z6DKKQvI/AAAAAAAACVU/jON4MaOvOg0/s1600/screenshot_1464.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="280" src="http://4.bp.blogspot.com/-MbOqpsdjh8o/UJ0z6DKKQvI/AAAAAAAACVU/jON4MaOvOg0/s640/screenshot_1464.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">zkm_decrypt.py loaded in DirtyJOE</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-3o6PIhBBVCQ/UJ00NVQAmxI/AAAAAAAACVc/ruNwlnz4IPI/s1600/screenshot_1465.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-3o6PIhBBVCQ/UJ00NVQAmxI/AAAAAAAACVc/ruNwlnz4IPI/s1600/screenshot_1465.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Decrypted</td></tr></tbody></table><br />Applying a SUB of 0x2a we get payload.class ( 9b7481ce8aa6844e25c196c13d9250d9 ) &nbsp;:<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-HJAlbAtpGRs/UJ5wHcay2QI/AAAAAAAACX0/TnuVMycHSzo/s1600/screenshot_1471.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="350" src="http://3.bp.blogspot.com/-HJAlbAtpGRs/UJ5wHcay2QI/AAAAAAAACX0/TnuVMycHSzo/s640/screenshot_1471.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Payload class in Java Decompiler.</td></tr></tbody></table><br /><br />&lt;/edit2&gt;<br />What about the % break. It seems it double the rate...but starting from around 6% we are now to something around 12%. As usual it's always difficult to talk about that, as the % depends of the traffic/country..etc<br />In Turkey, before this CVE, break % could reach 20% where rate for Germany was between 3 and 5%<br /><br /></div><div>Be ready to see same kind of post for Blackhole 2.0 (or update to 2.1) soon, as chances are HUGE that Paunch is indeed behind Cool EK code.<br /><br />Others changes : Old Flash exploit activated (/media/score.swf ), old PDF exploits added ( /media/pdf_old.php vs /media/pdf_new.php).<br />I won't spend time on this (at least right now)</div><div><br /></div><div>Read more ?<br /><a href="http://blogs.technet.com/b/mmpc/archive/2012/11/15/a-technical-analysis-on-new-java-vulnerability-cve-2012-5076.aspx">A technical analysis on new Java vulnerability (CVE-2012-5076)</a>&nbsp;- 15-11-2012 -&nbsp;Jeong Wook (Matt) Oh - MMPC<br />About Cool EK :</div><div><a href="http://malware.dontneedcoffee.com/2012/10/newcoolek.html">Cool Exploit Kit - A new Browser Exploit Pack on the Battlefield with a "Duqu" like font drop</a><br />About CVE and EK/BEP:<br /><a href="http://contagiodump.blogspot.nl/2010/06/overview-of-exploit-packs-update.html">An Overview of Exploit Packs (Update 17) October 12, 2012</a> - Mila - Contagio<br />About decrypting ZKM :<br /><a href="http://code.google.com/p/corkami/wiki/Java">http://code.google.com/p/corkami/wiki/Java</a>&nbsp;Ange Albertini - corkami - 07-11-2011<br /><a href="http://dirty-joe.com/help/python_scripting.php">http://dirty-joe.com/help/python_scripting.php</a><br /><br />Post Publication :<br /><a href="http://yomuds.blogspot.fr/2012/11/cve-2011-3402-and-cool-exploit-kit_28.html">CVE-2011-3402 and Cool Exploit Kit</a>&nbsp;- 2012-11-28 - yomuds -&nbsp;a bunch of random security bits!<br /><br />&lt;Edit 1: 13:14 09/11/12&gt;</div>Removed the references to CVE-2012-5067<br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-zzYa0Htyk8U/UJz6s0upYOI/AAAAAAAACQs/7meDU0L-RE8/s1600/screenshot_1458.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-zzYa0Htyk8U/UJz6s0upYOI/AAAAAAAACQs/7meDU0L-RE8/s1600/screenshot_1458.png" /></a></div><div class="separator" style="clear: both; text-align: left;">Thanks to&nbsp;<a href="https://twitter.com/TimoHirvonen">Timo Hirvonen</a>&nbsp;from&nbsp;<a href="https://twitter.com/FSecure">F-Secure</a>&nbsp;for&nbsp;<a href="https://twitter.com/TimoHirvonen/status/266882606862303232">pointing me</a>&nbsp;to the correct CVE associated to this exploit.</div>&lt;/edit1&gt;<br />&lt;edit2: more information on this Jar file.<br />Thanks to <a href="https://twitter.com/ange4771">Ange Albertini</a> for his help.<br />&lt;/edit2&gt;<br /><span style="color: #351c75;">&lt;edit3&gt;</span><br /><span style="color: #351c75; font-size: x-small;">I don't want to be guilty for an integration of this CVE in other Exploit Pack.</span><br /><span style="color: #351c75; font-size: x-small;">So don't expect freely avaiblable files from me as long as it's not widely used.</span><br /><span style="color: #351c75; font-size: x-small;">Password protected file :</span><br /><span style="color: #351c75; font-size: x-small;"><a href="http://goo.gl/TMXwx">http://goo.gl/TMXwx</a>&nbsp;(dropbox)</span><br /><span style="color: #351c75; font-size: x-small;"><a href="http://goo.gl/ElxSO">http://goo.gl/ElxSO</a> (Mega)</span><br /><span style="color: #351c75; font-size: x-small;"><br /></span><span style="color: #351c75; font-size: x-small;">kafeine at dontneedcoffee dot com for password.</span><br /><span style="color: #351c75; font-size: x-small;">No need to mail if you are not ready to give real name and company</span><br /><span style="color: #351c75;">&lt;/edit3&gt;</span><br />&lt;edit4 &nbsp;Jar image blurred.<br />Thanks to Michael Schierl<br />&lt;/edit4&gt;<br />&lt;edit 5 : Link in video dead, here is it. For those who do not like blur and so on :<br /><blockquote>In war, whatever your weakness/strengths are, better not help other side improve its weapons.</blockquote>&lt;/edit5&gt;<br /><br /><br /></div>